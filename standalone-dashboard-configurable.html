<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sales Dashboard - TV Display</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700;800&family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Load configuration -->
    <script src="dashboard-config.js"></script>
    
    <style>
        * {
            font-family: 'Manrope', 'Inter', sans-serif;
        }
        
        .scoreboard-table {
            font-size: 3.5rem;
            line-height: 1.2;
        }
        
        .agent-name {
            font-size: 4rem;
            font-weight: 800;
        }
        
        .team-name {
            font-size: 2.5rem;
            font-weight: 700;
        }
        
        .progress-text {
            font-size: 2.8rem;
            font-weight: 700;
        }
        
        .target-text {
            font-size: 2.2rem;
            font-weight: 600;
        }
        
        .status-badge {
            font-size: 1.8rem;
            font-weight: 800;
            padding: 0.8rem 1.6rem;
        }
        
        .news-ticker {
            font-size: 2.5rem;
            font-weight: 600;
        }
        
        .daily-targets-header {
            font-size: 3rem;
            font-weight: 800;
        }
        
        .daily-targets-table {
            font-size: 2.2rem;
            font-weight: 600;
        }
        
        .main-title {
            font-size: 8rem;
            font-weight: 900;
        }
        
        .date-time {
            font-size: 4rem;
            font-weight: 700;
        }
        
        @keyframes scroll-left {
            0% { transform: translateX(100%); }
            100% { transform: translateX(-100%); }
        }
        
        .ticker-scroll {
            animation: scroll-left var(--ticker-duration, 30s) linear infinite;
        }
        
        @keyframes fade-in {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .fade-in {
            animation: fade-in 0.5s ease-out;
        }
        
        .progress-bar {
            transition: width 0.8s ease-in-out;
        }
        
        .agent-photo {
            width: 6rem;
            height: 6rem;
            border-radius: 50%;
            object-fit: cover;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 text-white overflow-hidden">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Get configuration from external file
        const config = window.DASHBOARD_CONFIG || {};
        const sampleData = {
            agents: config.agents || [],
            teams: config.teams || [],
            newsTicker: config.newsTicker || ["Welcome to Sales Dashboard"],
            company: config.company || { name: "Sales Dashboard", currency: { symbol: "$", code: "USD" } },
            display: config.display || { autoScrollInterval: 6000, agentsPerPage: 2, workingDaysPerMonth: 22 },
            theme: config.theme || {}
        };

        function formatCurrency(amount) {
            const symbol = sampleData.company.currency.symbol || "$";
            return `${symbol} ${parseFloat(amount).toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
        }

        function calculateProgress(achieved, target) {
            return Math.min((parseFloat(achieved) / parseFloat(target)) * 100, 100);
        }

        function getProgressColor(percentage) {
            const colors = sampleData.theme.progressColors || {
                excellent: 'bg-green-500',
                good: 'bg-blue-500',
                warning: 'bg-yellow-500',
                danger: 'bg-red-500'
            };
            
            if (percentage >= 90) return colors.excellent;
            if (percentage >= 70) return colors.good;
            if (percentage >= 50) return colors.warning;
            return colors.danger;
        }

        function getStatusBadge(percentage) {
            if (percentage >= 75) {
                return <span className="status-badge bg-green-500 text-white px-4 py-2 rounded-full">ON TRACK</span>;
            }
            return <span className="status-badge bg-red-500 text-white px-4 py-2 rounded-full">BEHIND</span>;
        }

        function AgentRow({ agent, team, index }) {
            const volumeProgress = calculateProgress(agent.volumeAchieved, agent.volumeTarget);
            const unitsProgress = calculateProgress(agent.unitsAchieved, agent.unitsTarget);

            return (
                <tr className="border-b border-slate-700/50 hover:bg-slate-800/30 transition-colors">
                    <td className="p-6 text-center">
                        <div className="flex items-center justify-center gap-6">
                            <img 
                                src={agent.photo} 
                                alt={agent.name}
                                className="agent-photo"
                                onError={(e) => {
                                    e.target.src = `https://via.placeholder.com/96x96/${team.color.replace('#', '')}/FFFFFF?text=${agent.name.charAt(0)}`;
                                }}
                            />
                            <div className="text-left">
                                <div className="agent-name text-white">{agent.name}</div>
                                <div className="team-name" style={{color: team.color}}>{team.name}</div>
                            </div>
                        </div>
                    </td>
                    <td className="p-6 text-center">
                        <div className="progress-text text-white">
                            {formatCurrency(agent.volumeAchieved)} / {formatCurrency(agent.volumeTarget)}
                        </div>
                        <div className="w-full bg-slate-700 rounded-full h-4 mt-3">
                            <div 
                                className={`progress-bar h-4 rounded-full ${getProgressColor(volumeProgress)}`}
                                style={{width: `${volumeProgress}%`}}
                            ></div>
                        </div>
                        <div className="target-text text-slate-300 mt-2">{volumeProgress.toFixed(1)}%</div>
                    </td>
                    <td className="p-6 text-center">
                        <div className="progress-text text-white">
                            {agent.unitsAchieved} / {agent.unitsTarget}
                        </div>
                        <div className="w-full bg-slate-700 rounded-full h-4 mt-3">
                            <div 
                                className={`progress-bar h-4 rounded-full ${getProgressColor(unitsProgress)}`}
                                style={{width: `${unitsProgress}%`}}
                            ></div>
                        </div>
                        <div className="target-text text-slate-300 mt-2">{unitsProgress.toFixed(1)}%</div>
                    </td>
                    <td className="p-6 text-center">
                        <div className="progress-text text-white">{agent.totalSales}</div>
                    </td>
                    <td className="p-6 text-center">
                        {getStatusBadge(Math.min(volumeProgress, unitsProgress))}
                    </td>
                </tr>
            );
        }

        function TeamRanking({ teams, agents }) {
            const teamStats = teams.map(team => {
                const teamAgents = agents.filter(agent => agent.teamId === team.id);
                const totalVolumeAchieved = teamAgents.reduce((sum, agent) => sum + parseFloat(agent.volumeAchieved), 0);
                const totalUnitsAchieved = teamAgents.reduce((sum, agent) => sum + agent.unitsAchieved, 0);
                const totalVolumeTarget = parseFloat(team.volumeTarget);
                const totalUnitsTarget = team.unitsTarget;
                
                const volumeProgress = (totalVolumeAchieved / totalVolumeTarget) * 100;
                const unitsProgress = (totalUnitsAchieved / totalUnitsTarget) * 100;
                const avgProgress = (volumeProgress + unitsProgress) / 2;
                
                return {
                    ...team,
                    volumeAchieved: totalVolumeAchieved,
                    unitsAchieved: totalUnitsAchieved,
                    progress: avgProgress
                };
            }).sort((a, b) => b.progress - a.progress);

            return (
                <div className="bg-slate-800/50 backdrop-blur-sm rounded-3xl border border-slate-700/50 p-8">
                    <h3 className="daily-targets-header text-white mb-8 text-center">Team Rankings</h3>
                    <div className="space-y-6">
                        {teamStats.map((team, index) => (
                            <div key={team.id} className="flex items-center justify-between p-6 bg-slate-700/30 rounded-2xl">
                                <div className="flex items-center gap-6">
                                    <div className="daily-targets-table text-slate-300">#{index + 1}</div>
                                    <div>
                                        <div className="team-name" style={{color: team.color}}>{team.name}</div>
                                        <div className="target-text text-slate-400">{team.progress.toFixed(1)}% Complete</div>
                                    </div>
                                </div>
                                <div className="text-right">
                                    <div className="progress-text text-white">{formatCurrency(team.volumeAchieved.toString())}</div>
                                    <div className="target-text text-slate-400">{team.unitsAchieved} units</div>
                                </div>
                            </div>
                        ))}
                    </div>
                </div>
            );
        }

        function DailyTargets({ teams }) {
            const workingDaysInMonth = sampleData.display.workingDaysPerMonth;
            const currentDay = new Date().getDate();
            const remainingDays = Math.max(workingDaysInMonth - currentDay, 1);

            return (
                <div className="bg-slate-800/50 backdrop-blur-sm rounded-3xl border border-slate-700/50 p-8 mb-8">
                    <h3 className="daily-targets-header text-white mb-8 text-center">Daily Targets</h3>
                    <div className="overflow-hidden">
                        <table className="w-full">
                            <thead>
                                <tr className="border-b border-slate-600">
                                    <th className="daily-targets-table text-slate-300 p-4 text-left">Team</th>
                                    <th className="daily-targets-table text-slate-300 p-4 text-center">Daily Volume</th>
                                    <th className="daily-targets-table text-slate-300 p-4 text-center">Daily Units</th>
                                </tr>
                            </thead>
                            <tbody>
                                {teams.map(team => {
                                    const dailyVolume = parseFloat(team.volumeTarget) / workingDaysInMonth;
                                    const dailyUnits = Math.ceil(team.unitsTarget / workingDaysInMonth);
                                    
                                    return (
                                        <tr key={team.id} className="border-b border-slate-700/50">
                                            <td className="p-4">
                                                <div className="team-name" style={{color: team.color}}>{team.name}</div>
                                            </td>
                                            <td className="daily-targets-table text-white p-4 text-center">
                                                {formatCurrency(dailyVolume.toString())}
                                            </td>
                                            <td className="daily-targets-table text-white p-4 text-center">
                                                {dailyUnits}
                                            </td>
                                        </tr>
                                    );
                                })}
                            </tbody>
                        </table>
                    </div>
                </div>
            );
        }

        function NewsTicker({ messages }) {
            const [currentMessage, setCurrentMessage] = useState(0);
            const tickerSpeed = sampleData.display.newsTickerSpeed || 30;

            useEffect(() => {
                const interval = setInterval(() => {
                    setCurrentMessage(prev => (prev + 1) % messages.length);
                }, 5000);
                return () => clearInterval(interval);
            }, [messages.length]);

            return (
                <div className="fixed bottom-0 left-0 right-0 bg-gradient-to-r from-blue-600 to-purple-600 text-white py-4 overflow-hidden z-50">
                    <div 
                        className="news-ticker ticker-scroll whitespace-nowrap"
                        style={{'--ticker-duration': `${tickerSpeed}s`}}
                    >
                        {messages[currentMessage]}
                    </div>
                </div>
            );
        }

        function Dashboard() {
            const [currentTime, setCurrentTime] = useState(new Date());
            const [scrollOffset, setScrollOffset] = useState(0);

            useEffect(() => {
                const timeInterval = setInterval(() => {
                    setCurrentTime(new Date());
                }, 1000);

                // Auto-scroll agents
                const scrollInterval = setInterval(() => {
                    if (sampleData.agents.length > sampleData.display.agentsPerPage) {
                        setScrollOffset(prev => (prev + 1) % sampleData.agents.length);
                    }
                }, sampleData.display.autoScrollInterval);

                return () => {
                    clearInterval(timeInterval);
                    clearInterval(scrollInterval);
                };
            }, []);

            const agentsPerPage = sampleData.display.agentsPerPage;
            const displayedAgents = sampleData.agents.slice(scrollOffset, scrollOffset + agentsPerPage);
            if (displayedAgents.length < agentsPerPage && sampleData.agents.length > 1) {
                displayedAgents.push(...sampleData.agents.slice(0, agentsPerPage - displayedAgents.length));
            }

            return (
                <div className="min-h-screen p-8 pb-24">
                    {/* Header */}
                    <div className="text-center mb-12">
                        <h1 className="main-title text-white mb-4">{sampleData.company.name.toUpperCase()}</h1>
                        <div className="date-time text-slate-300">
                            {currentTime.toLocaleDateString()} â€¢ {currentTime.toLocaleTimeString()}
                        </div>
                    </div>

                    <div className="grid grid-cols-12 gap-8 h-[calc(100vh-300px)]">
                        {/* Main Scoreboard */}
                        <div className="col-span-8">
                            <div className="bg-slate-800/50 backdrop-blur-sm rounded-3xl border border-slate-700/50 p-8 h-full">
                                <div className="overflow-hidden h-full">
                                    <table className="w-full scoreboard-table">
                                        <thead>
                                            <tr className="border-b-2 border-slate-600">
                                                <th className="text-slate-300 p-6 text-center">Agent</th>
                                                <th className="text-slate-300 p-6 text-center">Volume Progress</th>
                                                <th className="text-slate-300 p-6 text-center">Units Progress</th>
                                                <th className="text-slate-300 p-6 text-center">Sales</th>
                                                <th className="text-slate-300 p-6 text-center">Status</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {displayedAgents.map((agent, index) => {
                                                const team = sampleData.teams.find(t => t.id === agent.teamId);
                                                return (
                                                    <AgentRow 
                                                        key={`${agent.id}-${index}`} 
                                                        agent={agent} 
                                                        team={team} 
                                                        index={index}
                                                    />
                                                );
                                            })}
                                        </tbody>
                                    </table>
                                </div>
                                
                                {/* Auto-scroll indicator */}
                                {sampleData.agents.length > agentsPerPage && (
                                    <div className="flex justify-center mt-6">
                                        <div className="flex space-x-2">
                                            {Array.from({ length: sampleData.agents.length }).map((_, index) => (
                                                <div
                                                    key={index}
                                                    className={`w-4 h-4 rounded-full transition-all duration-300 ${
                                                        index === scrollOffset ? 'bg-blue-500' : 'bg-slate-600'
                                                    }`}
                                                />
                                            ))}
                                        </div>
                                    </div>
                                )}
                            </div>
                        </div>

                        {/* Right Panel */}
                        <div className="col-span-4 space-y-8">
                            <DailyTargets teams={sampleData.teams} />
                            <TeamRanking teams={sampleData.teams} agents={sampleData.agents} />
                        </div>
                    </div>

                    {/* News Ticker */}
                    <NewsTicker messages={sampleData.newsTicker} />
                </div>
            );
        }

        ReactDOM.render(<Dashboard />, document.getElementById('root'));
    </script>
</body>
</html>